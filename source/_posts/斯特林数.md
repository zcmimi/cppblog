---
title: 斯特林数 
date: 2020-06-23 13:25
tags: 
 - 数论

categories:
 - [note]

top: 0 
html:
---

## 第一类斯特林数

### 定义

- $s(n,m)$表示将$n$个元素分成$m$个圆排列的方案数

- 记作$\begin{bmatrix}n\\m\end{bmatrix}$

### 递推式

$$
\begin{bmatrix}n\\m\end{bmatrix}=\begin{bmatrix}n-1\\m-1\end{bmatrix}+(n-1)\begin{bmatrix}n-1\\m\end{bmatrix}
$$

(当前元素可以建一个新环或放在已有的任意元素前面)

### 性质

$$
\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix} = n!
$$

证明: 每个排列实际上对应着一个置换

考虑$s(n,i)$分成的$i$个环,实际上就是对应着循环节个数为$i$的一种置换,一一对应过去就是所有置换方案就是全排列了

---

> 阶乘幂
> 
> 上升阶乘幂:
>
> $\begin{aligned}x^{\overline{n}}&=x(x+1)(x+2)\cdots(x+n-1)\\&=\frac{(x+n-1)!}{(x-1)!}\end{aligned}$
> 
> 下降阶乘幂:
> 
> $\begin{aligned}x^{\underline{n}}&=x(x-1)(x-2)\cdots(x-n+1)\\&=\frac{x!}{(x-n)!}\end{aligned}$

- **上升阶乘幂**

  $\displaystyle x^{\overline n}=\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix}x^i$
  
  证明:
  
  $
  \begin{aligned}
  x^{\overline{n+1}}
  &=(x+n)\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix}x^i\\
  &=\sum_{i=0}^{n+1}\begin{bmatrix}n\\i-1\end{bmatrix}x^i+n\sum_{i=0}^{n+1}\begin{bmatrix}n\\i\end{bmatrix}x^i\\
  &=\sum_{i=0}^{n+1}\left( \begin{bmatrix}n\\i-1\end{bmatrix}+n\begin{bmatrix}n\\i\end{bmatrix}\right)x^i\\
  &=\sum_{i=0}^{n+1}\begin{bmatrix}n+1\\i\end{bmatrix}x^i
  \end{aligned}
  $

- 下降阶乘幂
  
  $\displaystyle x^{\underline{n}}=\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix}(-1)^{n-i}x^i$
  
  证明(数学归纳法):
  
  $n=1$时,成立
  
  $n>1$时:
  
  $
  \begin{aligned}
  x^{\underline{n+1}}
  &=(x-n)x^{\underline{n}}\\
  &=(x-n)\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix}(-1)^{n-i}x^i\\
  &=\sum_{i=0}^{n+1} \begin{bmatrix}n\\i-1\end{bmatrix}(-1)^{n-i-1}x^i
  +n\sum_{i=0}^{n+1} \begin{bmatrix}n\\i\end{bmatrix}(-1)^{n-i+1}x^i\\
  &=\sum_{i=0}^{n+1}\left( \begin{bmatrix}n\\i-1\end{bmatrix} + n\begin{bmatrix}n\\i\end{bmatrix}\right)(-1)^{n-i+1}x^i\\
  &=\sum_{i=0}^{n+1}\begin{bmatrix}n+1\\i\end{bmatrix}(-1)^{n+1-i}x^i
  \end{aligned}
  $

### 自然数幂和

设$\displaystyle S_k(n)=\sum_{i=1}^n i^k$

$
\begin{aligned}
S_k(n)
&=\sum_{i=1}^n i^k\\
&=\sum_{i=1}^n \left( i^{\underline{k}} - \sum_{j=0}^{k-1} \begin{bmatrix}k\\j\end{bmatrix}(-1)^{k-j}i^j\right)\\
&=\sum_{i=1}^n i^{\underline{k}} - \sum_{j=0}^{k-1}(-1)^{k-j}\left( \sum_{x=1}^n x^j \right)\\
&=\frac{(n+1)^{\underline{k+1}}}{k+1} - \sum_{j=0}^{k-1} \begin{bmatrix}k\\j\end{bmatrix}(-1)^{k-j}S_j(n)
\end{aligned}
$

$
\begin{aligned}
S_k(n)
&=\sum_{i=1}^n i^k\\
&=\sum_{i=1}^n \left( i^{\overline{k}} - \sum_{j=0}^{k-1} \begin{bmatrix}k\\j\end{bmatrix}i^j\right)\\
&=\sum_{i=1}^n i^{\overline{k}} - \sum_{j=0}^{k-1}\left( \sum_{x=1}^n x^j \right)\\
&=\frac{(n+1)^{\overline{k+1}}}{k+1} - \sum_{j=0}^{k-1}\begin{bmatrix}k\\j\end{bmatrix}S_j(n)
\end{aligned}
$

### 快速计算

构造第一类斯特林数生成函数:

$\displaystyle
\sum_{i=0}^n \begin{bmatrix}n\\i\end{bmatrix} x^i
=\prod_{i=0}^{n-1} (x+i)
$

倍增:

设$\displaystyle F_n(x)=\prod_{i=0}^{n-1} (x+i)$

那么$F_{2n}=F_n(x)F_n(x+n)$

可以递归求解$F_n(x)$

考虑快速计算$F_n(x+n)$:

$\displaystyle
\begin{aligned}
F_n(x+n)
&=\sum_{i=0}^{n-1} \begin{bmatrix}n\\i\end{bmatrix} (x+n)^i\\
&=\sum_{i=0}^{n-1} \begin{bmatrix}n\\i\end{bmatrix} \sum_{j=0}^i {i\choose j} n^{i-j}x^j\\
&=\sum_{i=0}^{n-1}\left( \sum_{j=i}^n {j\choose i} n^{j-i} \begin{bmatrix}n\\j\end{bmatrix} \right)x^i
\end{aligned}
$

可以卷积求解

模板: 

[LG 5409 第一类斯特林数·列](https://www.luogu.com.cn/problem/P5409)

[LG 5408 第一类斯特林数·行](https://www.luogu.com.cn/problem/P5408)

## 第二类斯特林数

### 定义

$S(n,m)$表示把$n$个元素划分成$m$个子集的方案数

记作$\begin{Bmatrix}n\\m\end{Bmatrix}$

### 递推式

$$
\begin{Bmatrix}n\\m\end{Bmatrix}
=\begin{Bmatrix}n-1\\m-1\end{Bmatrix}
+m\cdot\begin{Bmatrix}n-1\\m\end{Bmatrix}
$$

(分到一个新的子集或者插入到已有的子集中)

### 性质

$\displaystyle
\begin{aligned}
\begin{Bmatrix}n\\m\end{Bmatrix}
&=\frac 1{m!} \sum_{i=0}^m(-1)^i {m\choose i}(m-i)^n\\
&=\sum_{i=0}^m \frac{(-1)^i}{i!}\cdot \frac{(m-i)^n}{(m-i)!}
\end{aligned}$

(可以看做进行容斥, 枚举多少个集合是空的, 其余的集合随便放置, 最后每一种情况会统计$m!$次)

可以卷积求解

---

$\displaystyle
m^n=\sum_{i=0}^m \begin{Bmatrix} n\\i \end{Bmatrix} m^{\underline{i}}
$

证明:

$\displaystyle
\begin{aligned}
m^n
&=\sum_{i=0}^m \begin{Bmatrix} n\\i \end{Bmatrix} {m\choose i} i!\\
&=\sum_{i=0}^m \begin{Bmatrix} n\\i \end{Bmatrix} m^{\underline{i}}
\end{aligned}
$

(可以看作将$n$个求放到$m$个带标号的盒子内,枚举哪些盒子不为空)

参考资料:

- https://zh.wikipedia.org/zh-cn/斯特林数
- https://ac.nowcoder.com/discuss/184169

