---
author: zc
avatar: null
categories:
- - 刷题记录
commnet: 1
date: 2020-07-11 07:34
html: '<details><summary>查看原题</summary><div id=''from''></div><p><button onclick="document.getElementById(''from'').innerHTML=''<iframe
  src=&quot;https://www.luogu.com.cn/problem/P5408&quot; width=100% height=800px style=&quot;border:
  none;&quot;><iframe>''" class=''mdui-btn mdui-btn-raised mdui-ripple''>点击加载</button><a
  class=''mdui-btn mdui-btn-raised mdui-ripple'' href="https://www.luogu.com.cn/problem/P5408"
  target=''_blank''>点击跳转</a><p></details>'
permalink: LG 5408 第一类斯特林数·行
tags: []
thumbnail: null
title: LG 5408 第一类斯特林数·行
top: 0

---

```cpp
#include<bits/stdc++.h>
const int N=100011,P=167772161,G,Gi;
int n,L,l,r[N];
void swap(int&x,int&y){x^=y,y^=x,x^=y;}
int pw(int x,int b){
    int res=1;
    while(b){
        if(b&1)res=1ll*res*x%P;
        b>>=1,x=1ll*x*x%P;
    }
    return res;
}
void ntt(int*A,int typ){
    for(int i=0;i<L;++i)
        if(i<r[i])swap(A[i],A[r[i]]);
    for(int len=1;len<L;len<<=1){
        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));
        for(int i=0;i<L;i+=len<<1){
            int w=1;
            for(int k=0;k<len;++k){
                int t=1ll*w*A[i+k+len]%P;
                A[i+k+len]=(A[i+k]-t)%P;
                A[i+k]=(A[i+k]+t)%P;
                w=1ll*w*Wn%P;
            }
        }
    }
    if(~typ)return;
    for(int i=0,inv=pw(L,P-2);i<L;++i)
        A[i]=1ll*A[i]*inv%P;
}
int s[N];
void solve(int n){
    if(!n){s[0]=1;return;}
    int m=n>>1;
    solve(m);
    
}
int main(){
    scanf("%d",&n);
    for(L=1;L<=n;L<<=1,++l);
    L<<=1,++l;
    for(int i=0;i<L;++i)
        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));
    
}
```
